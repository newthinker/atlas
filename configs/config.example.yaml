# ATLAS Configuration Example
# Copy this file to config.yaml and fill in your settings

server:
  host: "0.0.0.0"
  port: 8080
  mode: "release"  # release, debug
  api_key: "${ATLAS_API_KEY}"  # API key for REST API authentication (leave empty to disable)
  job_ttl_hours: 1             # How long to keep async job results
  max_jobs: 100                # Maximum concurrent async jobs

log:
  level: "info"  # debug, info, warn, error
  format: "json" # json, console

# Data collectors for market data
collectors:
  yahoo:
    enabled: true
    markets: ["US", "HK"]
    interval: "5m"
  eastmoney:
    enabled: true
    markets: ["CN_A"]
    interval: "30s"
  # Lixinger API for CN fundamental data
  lixinger:
    enabled: false
    api_key: "${LIXINGER_API_KEY}"
    markets: ["CN_A"]
    interval: "24h"

# Trading strategies
strategies:
  # Technical strategies
  ma_crossover:
    enabled: true
    params:
      fast_period: 50
      slow_period: 200
      ma_type: "sma"  # sma, ema
  # Fundamental strategies
  pe_band:
    enabled: false
    params:
      lookback_years: 5
      threshold_percentile: 20
  dividend_yield:
    enabled: false
    params:
      min_yield: 3.0
      min_payout_years: 5
      max_payout_ratio: 80

# Signal routing
router:
  min_confidence: 0.6
  cooldown_hours: 4

# Notification channels
notifiers:
  telegram:
    enabled: true
    bot_token: "${TELEGRAM_BOT_TOKEN}"
    chat_id: "${TELEGRAM_CHAT_ID}"
  email:
    enabled: false
    host: "smtp.gmail.com"
    port: 587
    username: "${EMAIL_USERNAME}"
    password: "${EMAIL_PASSWORD}"
    from: "ATLAS <atlas@example.com>"
    to:
      - "user@example.com"
  webhook:
    enabled: false
    url: "https://example.com/atlas-webhook"
    headers:
      Authorization: "Bearer ${WEBHOOK_TOKEN}"

# Storage configuration
storage:
  # Hot storage (recent data, fast access)
  hot:
    dsn: ""  # Empty for in-memory, or PostgreSQL DSN: "postgres://user:pass@localhost:5432/atlas"
    retention_days: 90
  # Cold storage (archived data)
  cold:
    type: "localfs"  # localfs, s3
    path: "./data/archive"
    s3:
      bucket: "atlas-archive"
      endpoint: "https://s3.amazonaws.com"
      region: "us-east-1"
      access_key: "${AWS_ACCESS_KEY_ID}"
      secret_key: "${AWS_SECRET_ACCESS_KEY}"
      prefix: "atlas/"

# LLM configuration
llm:
  provider: "claude"  # claude, openai, ollama
  claude:
    api_key: "${ANTHROPIC_API_KEY}"
    model: "claude-sonnet-4-20250514"
  openai:
    api_key: "${OPENAI_API_KEY}"
    model: "gpt-4o"
  ollama:
    endpoint: "http://localhost:11434"
    model: "qwen2.5:32b"

# LLM meta-strategies
meta:
  arbitrator:
    enabled: true
    context_days: 7  # Days of news/context for arbitration
  synthesizer:
    enabled: false
    schedule: "0 0 * * 0"  # Cron: weekly on Sunday midnight
    min_trades: 50          # Minimum trades required for analysis

# Broker integration
broker:
  enabled: false
  provider: "futu"  # futu
  mode: "paper"     # paper, live
  execution:
    mode: "confirm"       # auto, confirm, batch
    batch_time: "09:00"   # For batch mode (HH:MM)
    default_size_pct: 2   # 2% of portfolio per position
  risk:
    max_position_pct: 10      # Max 10% in single position
    max_daily_loss_pct: 5     # Stop trading if down 5% today
    max_open_positions: 20    # Max concurrent positions
  futu:
    host: "127.0.0.1"
    port: 11111
    env: "simulate"  # simulate, real
    trade_password: "${FUTU_TRADE_PWD}"
    rsa_key_path: ""

# Watchlist of symbols to monitor
watchlist:
  - symbol: "AAPL"
    name: "Apple Inc"
    strategies: ["ma_crossover"]
  - symbol: "MSFT"
    name: "Microsoft Corp"
    strategies: ["ma_crossover"]
  - symbol: "600519.SH"
    name: "Kweichow Moutai"
    strategies: ["ma_crossover", "pe_band", "dividend_yield"]
  - symbol: "0700.HK"
    name: "Tencent Holdings"
    strategies: ["ma_crossover"]

# Metrics configuration (Prometheus)
metrics:
  enabled: true
  path: "/metrics"

# Alerting configuration
alerts:
  enabled: true
  check_interval: 60s
  rules:
    - name: high_error_rate
      expr: "error_rate > 0.05"
      for: 5m
      severity: warning
      message: "API error rate above 5%"
    - name: api_down
      expr: "up == 0"
      for: 1m
      severity: critical
      message: "ATLAS API is not responding"
